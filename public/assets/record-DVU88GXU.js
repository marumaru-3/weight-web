import{e as f}from"./main.js";import{a as p,f as v,i as l,d as w,e as E}from"./form-validate-CVHGrpdv.js";const m=t=>{const n=s=>("0"+s).slice(-2),a=t.getFullYear().toString(),o=n(t.getMonth()+1).toString(),i=n(t.getDate()).toString();return`${a}/${o}/${i}`},T=()=>{const t=document.getElementById("date-contents"),n=document.getElementById("date-prev"),a=document.getElementById("date-next");if(!t)return;const o=new Date,s=new Intl.DateTimeFormat("ja-JP",{timeZone:"Asia/Tokyo",year:"numeric",month:"2-digit",day:"2-digit"}).formatToParts(o),u=s.find(d=>d.type==="year").value,y=s.find(d=>d.type==="month").value,g=s.find(d=>d.type==="day").value,r=new Date(`${u}-${y}-${g}T00:00:00+09:00`);let e=new Date(r);const D=document.getElementById("recorded_at"),c=()=>{t.textContent=m(e),D.value=m(e),a.disabled=e.getTime()>=r.getTime()};c(),n.addEventListener("click",()=>{e.setDate(e.getDate()-1),c()}),a.addEventListener("click",()=>{e.getTime()<r.getTime()&&(e.setDate(e.getDate()+1),c())})},F=async()=>{T(),p(),v("input[data-float]"),l(),document.addEventListener("input",l),document.addEventListener("change",l);const t=document.getElementById("record-form");t&&t.addEventListener("submit",async n=>{if(n.preventDefault(),w(),!E(t)){console.log("バリデーションエラー： フォーム送信をキャンセル");return}const o=new FormData(t),i=await f(o);window.history.scrollRestoration="manual",window.location.reload(),i.success||alert(i.message)})};export{F as init};
