const se=e=>{const t=document.createElement("div");t.textContent=e,t.classList.add("copy-dialog"),document.body.appendChild(t),setTimeout(()=>t.classList.add("show"),10),setTimeout(()=>t.classList.remove("show"),1500),setTimeout(()=>t.remove(),2e3)};document.addEventListener("click",e=>{if(e.target.classList.contains("copy-link")){const t=e.target.closest(".copy-contents").querySelector(".copy__value");t&&(navigator.clipboard.writeText(t.textContent),document.querySelector(".copy-dialog")||se("IDをコピーしました。"))}});const S=()=>{k(document.querySelector(".validate-form")),document.addEventListener("input",()=>k(document.querySelector(".validate-form"))),document.addEventListener("change",()=>k(document.querySelector(".validate-form"))),document.querySelectorAll(".next-btn, .prev-btn").forEach(e=>{e.addEventListener("click",()=>{k(document.querySelector(".validate-form"))})})},k=e=>{if(!e)return!1;const o=[...(e.querySelector(".step.visible")||e).querySelectorAll("[required]")].every(c=>c.type==="radio"||c.type==="checkbox"?e.querySelector(`input[name="${c.name}"]:checked`):c.id==="password"?c.value.length>3:c.value.trim()!=="");return document.querySelectorAll(".submit-btn").forEach(c=>{o?c.classList.remove("disabled"):c.classList.add("disabled"),c.disabled=!o}),o},O=()=>{document.querySelectorAll(".basic-info-form__box").forEach(t=>{const n=t.querySelector("input"),s=t.querySelectorAll("select");n&&V(n,t),s.length&&s.forEach(o=>{V(o,t)})})},ae=(e,t)=>{e.tagName==="SELECT"?e.addEventListener("change",()=>V(e,t)):e.addEventListener("input",()=>V(e,t))},V=(e,t)=>{let n=t.querySelector(".validate-text")||t.nextElementSibling;const s=t.querySelector(".label-title")?t.querySelector(".label-title").textContent:t.querySelector(".label-name").textContent,o=s.includes("（")?s.substr(0,s.indexOf("（")):s;if(e.id==="password"){if(e.validity.valueMissing)return n.textContent=`${o}を入力してください`,t.classList.add("no-text"),!1;if(e.value.length<4)return n.textContent=`${o}は4文字以上で入力してください`,t.classList.add("no-text"),!1}else if(e.tagName==="INPUT"&&e.validity.valueMissing||e.tagName==="SELECT"&&e.value==="")return n.textContent=`${o}を入力してください`,t.classList.add("no-text"),!1;return n.textContent="",t.classList.remove("no-text"),!0},P=()=>{document.querySelectorAll(".validate-form__input").forEach(t=>{const n=t.querySelector("input"),s=t.querySelector("select"),o=t.querySelector("button");t.addEventListener("click",a=>{a.target===n?(t.classList.add("click"),t.classList.add("text-on"),ae(n,t)):a.target===s&&t.classList.add("click")}),document.addEventListener("click",a=>{n&&a.target!==n&&a.target!==o?(t.classList.remove("click"),n.value.trim()===""&&t.classList.remove("text-on")):s&&a.target!==s&&t.classList.remove("click")})})},G=e=>{document.querySelectorAll(e).forEach(t=>{t.addEventListener("input",n=>{n.target.value=n.target.value.replace(/[^a-zA-Z0-9 !"#$%&'()*+,-./:;<=>?@[\\\]^_`{|}~]/g,"")})})},ce=e=>{document.querySelectorAll(e).forEach(t=>{t.addEventListener("input",n=>{n.target.value=n.target.value.replace(/[^0-9]/g,"")})})},z=e=>{document.querySelectorAll(e).forEach(t=>{t.addEventListener("input",n=>{n.target.value=n.target.value.replace(/[^0-9.]/g,"").replace(/(\..*)\./g,"$1")})})},ie=()=>{S();const e=document.querySelector(".basic-info-form");e&&e.addEventListener("submit",t=>{t.preventDefault()})},re=Object.freeze(Object.defineProperty({__proto__:null,init:ie},Symbol.toStringTag,{value:"Module"})),w=e=>{const t=e.replace(/^\/+/,"");return`${BASE_PATH}${t}`},le=e=>{const t=new Image;t.src=e},_=async(e,t="GET",n=null,s={})=>{const o=await fetch(e,{method:t,body:n,...s});try{if(!o.ok)throw new Error(`APIエラー: ${o.status}`);const a=o.headers.get("Content-Type");return a&&a.includes("application/json")?await o.json():await o.text()}catch(a){console.log("エラー:",a);const c=o.headers.get("Content-Type");return c&&c.includes("application/json")?(console.log(await o.json()),alert(`モーダルの読み込みに失敗しました。
`+a.message)):console.log(await o.text()),{success:!1,message:"通信エラーが発生しました。"}}},Z=async e=>_(w(`/index.php?modal=${e}`)),de=async e=>_(w("/index.php?modal=login"),"POST",e),ue=async e=>_(w("/index.php?modal=register"),"POST",e),me=async()=>_(w("/api/chart_data.php")),K=e=>{const t=e.target.closest("[data-date]");return t?t.dataset.date:null};let $={};const ge=async e=>{const t=K(e);if(!t)return null;if($[t])return $[t];const n=await _(w(`/api/record_data.php?date=${t}`));return n&&n.date?($[t]=n,$[t]):null},he=async e=>_(w("/index.php?modal=recordAdmin"),"POST",e),pe=async e=>_(w("/index.php?modal=record"),"POST",e),fe=async e=>_(w("/index.php?modal=recordDelete"),"POST",e),ye=async e=>_(w("/index.php?modal=recordReset"),"POST",e);let R=null;const ve=async()=>{if(R)return R;const e=await _(w("/api/user_data.php"));return e&&e.username?(R=e,R):null},we=async e=>_(w("/index.php?modal=adminUser"),"POST",e),_e=async e=>_(w("/index.php?modal=adminAccount"),"POST",e),be=async e=>_(w("/index.php?modal=accountDelete"),"POST",e),Se=()=>{document.querySelector(".account-delete")&&document.getElementById("acc-delete-btn").addEventListener("click",async n=>{n.preventDefault();const s=await be();window.history.scrollRestoration="manual",window.location.reload(),s.success||alert(s.message)})},Ee=Object.freeze(Object.defineProperty({__proto__:null,init:Se},Symbol.toStringTag,{value:"Module"})),Le=async()=>{P(),S(),G("input[data-alphanumeric]"),ce("input[data-numeric]");const e=document.getElementById("login-form");e&&e.addEventListener("submit",async t=>{if(t.preventDefault(),O(),!k(e)){console.log("バリデーションエラー： フォーム送信をキャンセル");return}const s=new FormData(e),o=await de(s),a=document.querySelector(".form-message");o.success?window.location.href=w("/home"):(a.classList.add("error"),a.innerHTML=`ログインに失敗しました。<br>${o.errorMessage}`,a.style.display="block")})},De=Object.freeze(Object.defineProperty({__proto__:null,init:Le},Symbol.toStringTag,{value:"Module"})),X=()=>{document.querySelectorAll(".btn--go-to-step2")&&document.querySelectorAll(".btn--go-to-step2").forEach(n=>{n.addEventListener("click",J)}),document.getElementById("btn--go-to-step2")&&document.getElementById("btn--go-to-step2").addEventListener("click",J),document.getElementById("btn--back-to-step1").addEventListener("click",qe)},J=()=>{document.getElementById("step1").classList.add("hidden"),document.getElementById("step1").classList.remove("visible"),document.getElementById("step2").classList.add("visible"),document.getElementById("step2").classList.remove("hidden")},qe=()=>{document.getElementById("step2").classList.add("hidden"),document.getElementById("step2").classList.remove("visible"),document.getElementById("step1").classList.add("visible"),document.getElementById("step1").classList.remove("hidden")},Te=()=>{X();const e=document.querySelectorAll(".notice-contents"),t=document.querySelectorAll(".notice-detail"),n=o=>{t.forEach(a=>{a.classList.toggle("visible",a.id===o),a.classList.toggle("hidden",a.id!==o)})};e.forEach(o=>{o.addEventListener("click",()=>{n(o.dataset.notice)})});const s=document.querySelector("#header__notifications span");s.dataset.icon="notifications"},ke=Object.freeze(Object.defineProperty({__proto__:null,init:Te},Symbol.toStringTag,{value:"Module"})),Be=e=>{P(),z("input[data-float]");const t=document.querySelector(".modal-record-admin");if(e){const s=e.date.replace(/-/g,"/");t.querySelector(".date__contents").textContent=s,t.querySelector("#recorded_at").value=s,t.querySelector("#weight").value=e.weight,t.querySelector("#memo").value=e.memo||""}S(),document.addEventListener("input",S),document.addEventListener("change",S);const n=document.getElementById("record-form");n&&(n.addEventListener("submit",async o=>{if(o.preventDefault(),O(),!k(n)){console.log("バリデーションエラー： フォーム送信をキャンセル");return}const c=new FormData(n),l=await he(c);window.history.scrollRestoration="manual",window.location.reload(),l.success||alert(l.message)}),document.getElementById("delete-btn").addEventListener("click",async o=>{o.preventDefault();const a=new FormData(n),c=await fe(a);window.history.scrollRestoration="manual",window.location.reload(),c.success||alert(c.message)}))},xe=Object.freeze(Object.defineProperty({__proto__:null,init:Be},Symbol.toStringTag,{value:"Module"})),Me=()=>{document.querySelector(".record-reset")&&document.getElementById("reset-btn").addEventListener("click",async n=>{n.preventDefault();const s=await ye();window.history.scrollRestoration="manual",window.location.reload(),s.success||alert(s.message)})},Ie=Object.freeze(Object.defineProperty({__proto__:null,init:Me},Symbol.toStringTag,{value:"Module"})),Q=e=>{const t=a=>("0"+a).slice(-2),n=e.getFullYear().toString(),s=t(e.getMonth()+1).toString(),o=t(e.getDate()).toString();return`${n}/${s}/${o}`},Ce=()=>{const e=document.getElementById("date-contents"),t=document.getElementById("date-prev"),n=document.getElementById("date-next");if(!e)return;const s=new Date,a=new Intl.DateTimeFormat("ja-JP",{timeZone:"Asia/Tokyo",year:"numeric",month:"2-digit",day:"2-digit"}).formatToParts(s),c=a.find(I=>I.type==="year").value,l=a.find(I=>I.type==="month").value,i=a.find(I=>I.type==="day").value,g=new Date(`${c}-${l}-${i}T00:00:00+09:00`);let f=new Date(g);const r=document.getElementById("recorded_at"),D=()=>{e.textContent=Q(f),r.value=Q(f),n.disabled=f.getTime()>=g.getTime()};D(),t.addEventListener("click",()=>{f.setDate(f.getDate()-1),D()}),n.addEventListener("click",()=>{f.getTime()<g.getTime()&&(f.setDate(f.getDate()+1),D())})},Ae=async()=>{Ce(),P(),z("input[data-float]"),S(),document.addEventListener("input",S),document.addEventListener("change",S);const e=document.getElementById("record-form");e&&e.addEventListener("submit",async t=>{if(t.preventDefault(),O(),!k(e)){console.log("バリデーションエラー： フォーム送信をキャンセル");return}const s=new FormData(e),o=await pe(s);window.history.scrollRestoration="manual",window.location.reload(),o.success||alert(o.message)})},je=Object.freeze(Object.defineProperty({__proto__:null,init:Ae},Symbol.toStringTag,{value:"Module"})),ee=()=>{const e=document.getElementById("birth-year"),t=document.getElementById("birth-month"),n=document.getElementById("birth-day");if(!e)return;const s=new Date().getFullYear();for(let a=s;a>=s-100;a--){let c=document.createElement("option");c.value=a,c.textContent=a,e.appendChild(c)}const o=()=>{const a=parseInt(e.value,10),c=parseInt(t.value,10);if(t.disabled=!a,n.disabled=!c,!c)return;const l=new Date(a,c,0).getDate();for(;n.options.length>1;)n.remove(1);for(let i=1;i<=l;i++){let g=document.createElement("option");g.value=i,g.textContent=i,n.appendChild(g)}};e.addEventListener("change",o),t.addEventListener("change",o),requestAnimationFrame(()=>{o()})},Oe=()=>{ee(),P(),S(),G("input[data-alphanumeric]"),z("input[data-float]"),X();const e=document.getElementById("register-form");e&&e.addEventListener("submit",async t=>{if(t.preventDefault(),O(),!k(e)){console.log("バリデーションエラー： フォーム送信をキャンセル");return}const s=new FormData(e),o=await ue(s),a=document.querySelector(".form-message");o.success?(sessionStorage.setItem("accountCreated","true"),window.location.href=w("/home")):(a.classList.add("error"),a.innerHTML=`新規登録に失敗しました。<br>${o.errorMessage}`,a.style.display="block")})},Pe=Object.freeze(Object.defineProperty({__proto__:null,init:Oe},Symbol.toStringTag,{value:"Module"})),Fe=e=>{ee(),P(),G("input[data-alphanumeric]"),z("input[data-float]");const t=document.querySelector("#user-info-form"),n=document.querySelector(".admin-account-form"),s=document.querySelector(".admin-user-form"),o=document.querySelector(".modal");if(e){o.querySelector("#username").value=e.username,o.querySelector("#birth-year").value=e.birth_year,o.querySelector("#birth-month").value=e.birth_month,requestAnimationFrame(()=>{o.querySelector("#birth-day").value=e.birth_day});const a=document.querySelector(`input[name="gender"][value="${e.gender}`);a.checked=!0,o.querySelector("#height").value=e.height,o.querySelector("#ideal-weight").value=e.ideal_weight}S(),document.addEventListener("input",S),document.addEventListener("change",S),t&&t.addEventListener("submit",async a=>{if(a.preventDefault(),O(),!k(t)){console.log("バリデーションエラー： フォーム送信をキャンセル");return}const l=new FormData(t);let i;n&&(i=await _e(l)),s&&(i=await we(l)),window.history.scrollRestoration="manual",window.location.reload(),i.success||alert(i.message)})},$e=Object.freeze(Object.defineProperty({__proto__:null,init:Fe},Symbol.toStringTag,{value:"Module"})),Re=async()=>{const e=document.querySelectorAll(".pwd-btn");e.length&&e.forEach(t=>{t.addEventListener("click",()=>{const n=t.previousElementSibling,s=n.tagName.toLowerCase(),o=t.firstElementChild,a=t.dataset.hidden==="true";s==="input"&&(n.type=a?"text":"password"),a?o.dataset.icon="visibility_off":o.dataset.icon="visibility",t.dataset.hidden=!a})})},te=document.querySelector("body"),He=document.getElementById("layout");let H=!1;const C=new Map,Ve=(e,t)=>{const n={record:"./init/record.js",recordAdmin:"./init/record-admin.js",recordReset:"./init/record-reset.js",adminAccount:"./init/user-info.js",adminUser:"./init/user-info.js",login:"./init/login.js",register:"./init/register.js",accountCreated:"./init/account-created.js",accountDelete:"./init/account-delete.js",notifications:"./init/notifications.js"},s=Object.assign({"./init/account-created.js":re,"./init/account-delete.js":Ee,"./init/login.js":De,"./init/notifications.js":ke,"./init/record-admin.js":xe,"./init/record-reset.js":Ie,"./init/record.js":je,"./init/register.js":Pe,"./init/user-info.js":$e}),o=n[e],a=s[o];o&&typeof a.init=="function"&&a.init(t)},ze=async(e,t=null)=>{let n=e,s=null;if(C.has(n))return;const o=await Z(e);C.set(n,{modalHtml:o,fetchData:s})},Y=async(e,t,n=null)=>{if(H)return;H=!0;let s=null;if(n&&C.has(n)){const a=C.get(n);s=a.modalHtml,t=a.fetchData}else s=await Z(e);if(s.success===!1){H=!1;return}He.insertAdjacentHTML("afterend",s),te.style.overflow="hidden",Re(),Ve(e,t),document.querySelectorAll(".close-modal").forEach(a=>{a&&a.addEventListener("click",ne)}),H=!1},ne=()=>{const e=document.getElementById("modal");e&&(e.remove(),te.style.overflow="")},Ne=document.querySelectorAll("[data-modal]");Ne.forEach(e=>{e.addEventListener("click",async()=>{const t=e.getAttribute("data-modal");let n=null,s=t;if(t==="recordAdmin"){const o=K(e);o&&(s=`recordAdmin-${o}`)}C.has(s)?n=C.get(s).fetchData:(t==="recordAdmin"&&(n=await ge(e)),t==="adminUser"&&(n=await ve())),t==="record"&&le("/images/date-arrow.svg"),console.log(C),Y(t,n,s)})});document.addEventListener("click",e=>{const t=document.querySelector("#modal.record, #modal.recordAdmin");t&&e.target===t&&ne()});window.addEventListener("load",()=>{setTimeout(()=>{ze("record")},1e3)});sessionStorage.getItem("accountCreated")==="true"&&(Y("accountCreated"),sessionStorage.removeItem("accountCreated"));showIdModal&&Y("idCheck");const Ue=()=>{const e=document.getElementById("header");if(!e)return;const t=e.offsetHeight;let n=0;window.addEventListener("load",()=>{window.addEventListener("scroll",()=>{const l=window.scrollY||document.documentElement.scrollTop;l>n&&l>t?e.style.top=`-${t}px`:e.style.top="0",n=l})});const s=document.getElementById("menu-toggle"),o=document.querySelector(".layout__sidebar");s.addEventListener("click",()=>{o.classList.contains("open")?(o.classList.remove("open"),o.classList.add("close")):(o.classList.remove("close"),o.classList.add("open"))});const a=window.matchMedia("(max-width: 1299px)"),c=l=>{l.matches?(o.classList.remove("open"),o.classList.add("close")):(o.classList.remove("close"),o.classList.add("open"))};c(a),a.addEventListener("change",c),document.addEventListener("click",l=>{l.target.closest(".layout__sidebar")||a.matches&&(o.classList.remove("open"),o.classList.add("close"))})},We=()=>{const e=document.querySelectorAll(".accordion-btn");e&&e.forEach(t=>{t.addEventListener("click",()=>{const n=t.closest(".accordion"),s=n.querySelector(".accordion-content");n.getAttribute("data-state")==="open"?(s.style.maxHeight=s.scrollHeight+"px",requestAnimationFrame(()=>{s.style.maxHeight="0"}),n.setAttribute("data-state","close")):(s.style.maxHeight=s.scrollHeight+"px",n.setAttribute("data-state","open"))})})},Ge=()=>{const e=document.getElementById("header__info"),t=document.getElementById("header__profile"),n=document.getElementById("user-popup");e&&(t.addEventListener("click",s=>{e.classList.contains("click")?e.classList.remove("click"):e.classList.add("click"),s.stopPropagation()}),document.addEventListener("click",s=>{!n.contains(s.target)&&s.target!==e&&e.classList.remove("click")}))},Ye=()=>{const e=document.querySelector(".weight-days__blocks"),t=document.querySelectorAll(".weight-days__block");if(!e)return;const n=i=>[...t].sort((g,f)=>{const r=g.querySelector(".weight-days__date").textContent,D=f.querySelector(".weight-days__date").textContent;return i?r<D?-1:1:r>D?-1:1});let s=!1;e.innerHTML="",n(s).forEach(i=>e.appendChild(i));const o=document.querySelector(".weight-days .btn--more");let a=6;const c=i=>{i.forEach((g,f)=>{f<a?g.classList.add("show"):g.classList.contains("show")&&g.classList.remove("show")}),a>=i.length&&o.classList.add("hide")};c(n(s)),o.addEventListener("click",()=>{a+=6,c(n(s))}),document.querySelectorAll(".weight-days__switch button").forEach(i=>{i.addEventListener("click",()=>{var g;(g=document.querySelector(".weight-days__switch .btn--select"))==null||g.classList.remove("btn--select"),i.classList.add("btn--select"),s?s=!1:s=!0,e.innerHTML="",n(s).forEach(f=>e.appendChild(f)),c(n(s))})})},Je=async()=>{const e=document.getElementById("graph");if(!e)return;const t=await me(),n=t.chart_arr,s=t.ideal_weight;Chart.register(window["chartjs-plugin-annotation"]);const o=(d,h=!1)=>{const m=new Date;m.setHours(0,0,0,0);let E=new Date(m.setDate(m.getDate()+1)),L=new Date(m);const b={"7d":[7,14],"1m":[1,2],"3m":[3,6],"6m":[6,12],"1y":[12,24]};d==="7d"?(E.setDate(m.getDate()-(h?b[d][1]:b[d][0])),h&&L.setDate(m.getDate()-b[d][0])):(E.setMonth(m.getMonth()-(h?b[d][1]:b[d][0])),h&&L.setMonth(m.getMonth()-b[d][0]));let y=[],v=new Date(E);for(;v<L;)y.push(new Date(v.getTime()-v.getTimezoneOffset()*6e4).toISOString().split("T")[0]),v.setDate(v.getDate()+1);return y},a=(d,h=!1)=>{const m=o(d,h),E=Object.fromEntries(n.map(p=>[p.date,p.weight])),L=Object.fromEntries(n.map(p=>[p.date,p.bmi])),b=Object.fromEntries(n.map(p=>[p.date,p.bfp])),y=m.map(p=>E[p]??null),v=m.map(p=>L[p]??null),B=m.map(p=>b[p]??null);return{labels:m,dataset:y,bmi:v,bfp:B}},c=window.matchMedia("(max-width: 599px)");let l;const i=d=>{const{labels:h,dataset:m}=a(d),E=h.map(y=>y.replaceAll("-","/")),L=e.getContext("2d");l&&l.destroy(),l=new Chart(L,{type:"line",data:{labels:E,datasets:[{label:"体重（kg）",data:m,backgroundColor:"#4a90e2",borderColor:"#4a90e2",borderWidth:2,pointRadius:4,pointBackgroundColor:"#fff",pointBorderColor:"#4a90e2",pointBorderWidth:3,hoverBorderWidth:4,pointHoverRadius:6,spanGaps:!0}]},options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:c.matches?4/3:2/1,scales:{x:{ticks:{autoSkip:!0,callback(y){return h[y]?`${new Date(h[y]).getDate()}日`:""},maxRotation:0,minRotation:0,maxTicksLimit:15}},y:{suggestedMax:Math.max(...m)+1,suggestedMin:s-1,ticks:{maxTicksLimit:c.matches?6:8}}},plugins:{legend:{display:!1},tooltip:{titleFont:{size:c.matches?10:12,family:"Inter, Noto Sans JP, sans-serif"},bodyFont:{size:c.matches?12:14,family:"Inter, Noto Sans JP, sans-serif"},callbacks:{label(y){return` 体重: ${y.raw} kg`}}},annotation:{annotations:{goalLine:{type:"line",yMin:s,yMax:s,borderColor:"#e65100",borderWidth:2,borderDash:[6,6],label:{content:"目標体重",enabled:!0,position:"end"}}}}}}});const b=y=>{const v=y,B=Math.ceil(h.length/v);let p=0;l.data.datasets[0].data=m.map((F,j,x)=>{const u=x.length-1,q=u-j;if(j===u||q%B===0){let N=m.slice(p,j+1).filter(W=>W),T=N.reduce((W,oe)=>parseFloat(W)+parseFloat(oe),0);if(!T)return null;let U=(T/N.length).toFixed(1);return p=j+1,U}else return null})};if(c.matches?(b(12),l.update()):(b(31),l.update()),d==="3m"||d==="6m"||d==="1y"){let y=null;l.options.scales.x.ticks.callback=v=>{let B=new Date(h[v]),p=B.getMonth()+1,F=B.getDate();if(!(p===y||F!==1))return y=p,`${p}月`},l.update()}},g=d=>{const h=o(d).map(L=>L.replaceAll("-","/")),m=h[0],E=h[h.length-1];return`${m}～${E}`},f=document.querySelector(".weight-graph__date");let r="1m";i(r),f.innerHTML=g(r),c.addEventListener("change",()=>i(r));const D=document.querySelectorAll(".weight-graph__switch button"),I=document.querySelectorAll(".weight-summary__block");if(D.length<1)return;D.forEach(d=>{d.addEventListener("click",()=>{var h;(h=document.querySelector(".weight-graph__switch .btn--select"))==null||h.classList.remove("btn--select"),d.classList.add("btn--select")})});const A=d=>{const h=a(d),m=h.dataset.filter(u=>u!==null),E=h.bmi.filter(u=>u!==null),L=h.bfp.filter(u=>u!==null),y=a(d,!0).dataset.filter(u=>u!==null),v=(u,q=1)=>{const M=u.filter(T=>T!=null).map(T=>parseFloat(T.replace(/,/g,"")));return M.length?(M.reduce((T,U)=>T+U,0)/M.length).toFixed(q):null},B=(u,q)=>{if(u.length&&q.length){const M=(v(u)-v(q)).toFixed(1);return M>0?"+"+M:String(M)}else return null},p=u=>u.length?Math.max(...u).toFixed(1):null,F=u=>u.length?Math.min(...u).toFixed(1):null,j={average:v(m),bfp:v(L,2),bmi:v(E,2),in_de:B(m,y),best:p(m),lowest:F(m)};let x;d==="7d"&&(x="1週間"),d==="1m"&&(x="1ヶ月"),d==="3m"&&(x="3ヶ月"),d==="6m"&&(x="半年"),d==="1y"&&(x="1年"),I.forEach(u=>{u.querySelector(".period").innerHTML=x;const q=j[u.dataset.summary];q?u.querySelector(".weight-summary__num").innerHTML=q:u.querySelector(".weight-summary__num").innerHTML="--"})};A(r),document.getElementById("weight-graph__week").addEventListener("click",()=>{r="7d",i(r),f.innerHTML=g(r),A(r)}),document.getElementById("weight-graph__month").addEventListener("click",()=>{r="1m",i(r),f.innerHTML=g(r),A(r)}),document.getElementById("weight-graph__three-month").addEventListener("click",()=>{r="3m",i(r),f.innerHTML=g(r),A(r)}),document.getElementById("weight-graph__half-year").addEventListener("click",()=>{r="6m",i(r),f.innerHTML=g(r),A(r)}),document.getElementById("weight-graph__year").addEventListener("click",()=>{r="1y",i(r),f.innerHTML=g(r),A(r)})};document.querySelector("#header")&&Ue();document.querySelector(".accordion")&&We();document.querySelector("#header__info")&&Ge();document.querySelector(".weight-days__blocks")&&Ye();document.querySelector("#graph")&&Je();
