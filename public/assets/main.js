const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["account-created-CQW4UpXI.js","form-validate-CVHGrpdv.js","login-CioBE2rb.js","record-admin-CrxHMQqo.js","record-DVU88GXU.js","register-CuBKLh5b.js","form-date-DC5VUZ3x.js","user-info-BbyuT7Ux.js"])))=>i.map(i=>d[i]);
const G=e=>{const t=document.createElement("div");t.textContent=e,t.classList.add("copy-dialog"),document.body.appendChild(t),setTimeout(()=>t.classList.add("show"),10),setTimeout(()=>t.classList.remove("show"),1500),setTimeout(()=>t.remove(),2e3)};document.addEventListener("click",e=>{if(e.target.classList.contains("copy-link")){const t=e.target.closest(".copy-contents").querySelector(".copy__value");t&&(navigator.clipboard.writeText(t.textContent),document.querySelector(".copy-dialog")||G("IDをコピーしました。"))}});const z="modulepreload",N=function(e){return"/assets/"+e},F={},A=function(t,o,a){let n=Promise.resolve();if(o&&o.length>0){document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),c=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));n=Promise.allSettled(o.map(l=>{if(l=N(l),l in F)return;F[l]=!0;const f=l.endsWith(".css"),w=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${w}`))return;const s=document.createElement("link");if(s.rel=f?"stylesheet":z,f||(s.as="script"),s.crossOrigin="",s.href=l,c&&s.setAttribute("nonce",c),document.head.appendChild(s),f)return new Promise((M,I)=>{s.addEventListener("load",M),s.addEventListener("error",()=>I(new Error(`Unable to preload CSS for ${l}`)))})}))}function r(u){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=u,window.dispatchEvent(c),!c.defaultPrevented)throw u}return n.then(u=>{for(const c of u||[])c.status==="rejected"&&r(c.reason);return t().catch(r)})},_=e=>{const t=e.replace(/^\/+/,"");return`${BASE_PATH}${t}`},E=async(e,t="GET",o=null,a={})=>{const n=await fetch(e,{method:t,body:o,...a});try{if(!n.ok)throw n.status===401&&(alert("ログインが必要です。"),window.location.href=_("/welcome")),new Error(`APIエラー: ${n.status}`);const r=n.headers.get("Content-Type");return r&&r.includes("application/json")?await n.json():await n.text()}catch(r){return console.log("エラー:",r),console.log("デバッグ:",await n.text()),{success:!1,message:"通信エラーが発生しました。"}}},J=async e=>E(_(`/index.php?modal=${e}`)),ce=async e=>E(_("/index.php?modal=login"),"POST",e),ie=async e=>E(_("/index.php?modal=register"),"POST",e),Q=async()=>E(_("/api/chart_data.php")),Y=e=>{const t=e.target.closest("[data-date]");return t?t.dataset.date:null},K=async e=>{const t=Y(e);return t?E(_(`/api/record_data.php?date=${t}`)):(console.log("日付を取得できませんでした。"),{success:!1,message:"日付を取得できませんでした。"})},le=async e=>E(_("/index.php?modal=recordAdmin"),"POST",e),de=async e=>E(_("/index.php?modal=record"),"POST",e),ue=async e=>E(_("/index.php?modal=recordDelete"),"POST",e),me=async e=>E(_("/index.php?modal=recordReset"),"POST",e),X=async()=>E(_("/api/user_data.php")),he=async e=>E(_("/index.php?modal=adminUser"),"POST",e),pe=async e=>E(_("/index.php?modal=adminAccount"),"POST",e),fe=async e=>E(_("/index.php?modal=accountDelete"),"POST",e),$=async()=>{const e=document.querySelectorAll(".pwd-btn");e.length&&e.forEach(t=>{t.addEventListener("click",()=>{const o=t.previousElementSibling,a=o.tagName.toLowerCase(),n=t.firstElementChild,r=t.dataset.hidden==="true";a==="input"&&(o.type=r?"text":"password"),r?n.innerHTML="visibility_off":n.innerHTML="visibility",t.dataset.hidden=!r})})},U=document.querySelector("body"),Z=document.getElementById("layout");let j=!1;const H=async(e,t=null)=>{if(j)return;j=!0;let o=null;e==="recordAdmin"&&t&&(o=await K(t)),e==="adminUser"&&(o=await X());const a=await J(e);Z.insertAdjacentHTML("afterend",a),U.style.overflow="hidden",te(e,o),$(),document.querySelectorAll(".close-modal").forEach(r=>{r&&r.addEventListener("click",W)}),j=!1},W=()=>{const e=document.getElementById("modal");e&&(e.remove(),U.style.overflow="",$())},ee=document.querySelectorAll("[data-modal]");ee.forEach(e=>{e.addEventListener("click",t=>{const o=e.getAttribute("data-modal");H(o,t)})});document.addEventListener("click",e=>{const t=document.querySelector("#modal.record, #modal.recordAdmin");t&&e.target===t&&W()});sessionStorage.getItem("accountCreated")==="true"&&(H("accountCreated"),sessionStorage.removeItem("accountCreated"));showIdModal&&H("idCheck");const te=(e,t)=>{const o={record:"./init/record.js",recordAdmin:"./init/record-admin.js",recordReset:"./init/record-reset.js",adminAccount:"./init/user-info.js",adminUser:"./init/user-info.js",login:"./init/login.js",register:"./init/register.js",accountCreated:"./init/account-created.js",accountDelete:"./init/account-delete.js"},a=Object.assign({"./init/account-created.js":()=>A(()=>import("./account-created-CQW4UpXI.js"),__vite__mapDeps([0,1])),"./init/account-delete.js":()=>A(()=>import("./account-delete-BnrA96Vl.js"),[]),"./init/login.js":()=>A(()=>import("./login-CioBE2rb.js"),__vite__mapDeps([2,1])),"./init/record-admin.js":()=>A(()=>import("./record-admin-CrxHMQqo.js"),__vite__mapDeps([3,1])),"./init/record-reset.js":()=>A(()=>import("./record-reset-DtVuFXUd.js"),[]),"./init/record.js":()=>A(()=>import("./record-DVU88GXU.js"),__vite__mapDeps([4,1])),"./init/register.js":()=>A(()=>import("./register-CuBKLh5b.js"),__vite__mapDeps([5,1,6])),"./init/user-info.js":()=>A(()=>import("./user-info-BbyuT7Ux.js"),__vite__mapDeps([7,6,1]))}),n=o[e];n&&a[n]?a[n]().then(r=>r.init(t)):console.warn(`未対応のモーダルタイプ: ${e}`)},ne=()=>{const e=document.getElementById("header");if(!e)return;const t=e.offsetHeight;let o=0;window.addEventListener("load",()=>{window.addEventListener("scroll",()=>{const c=window.scrollY||document.documentElement.scrollTop;c>o&&c>t?e.style.top=`-${t}px`:e.style.top="0",o=c})});const a=document.getElementById("menu-toggle"),n=document.querySelector(".layout__sidebar");a.addEventListener("click",()=>{n.classList.contains("open")?(n.classList.remove("open"),n.classList.add("close")):(n.classList.remove("close"),n.classList.add("open"))});const r=window.matchMedia("(max-width: 1299px)"),u=c=>{c.matches?(n.classList.remove("open"),n.classList.add("close")):(n.classList.remove("close"),n.classList.add("open"))};u(r),r.addEventListener("change",u),document.addEventListener("click",c=>{c.target.closest(".layout__sidebar")||r.matches&&(n.classList.remove("open"),n.classList.add("close"))})},oe=()=>{const e=document.querySelectorAll(".accordion-btn");e&&e.forEach(t=>{t.addEventListener("click",()=>{const o=t.closest(".accordion"),a=o.querySelector(".accordion-content");o.getAttribute("data-state")==="open"?(a.style.maxHeight=a.scrollHeight+"px",requestAnimationFrame(()=>{a.style.maxHeight="0"}),o.setAttribute("data-state","close")):(a.style.maxHeight=a.scrollHeight+"px",o.setAttribute("data-state","open"))})})},se=()=>{const e=document.getElementById("header__info"),t=document.getElementById("header__profile"),o=document.getElementById("user-popup");e&&(t.addEventListener("click",a=>{e.classList.contains("click")?e.classList.remove("click"):e.classList.add("click"),a.stopPropagation()}),document.addEventListener("click",a=>{!o.contains(a.target)&&a.target!==e&&e.classList.remove("click")}))},ae=()=>{const e=document.querySelector(".weight-days__blocks"),t=document.querySelectorAll(".weight-days__block");if(!e)return;const o=l=>[...t].sort((f,w)=>{const s=f.querySelector(".weight-days__date").textContent,M=w.querySelector(".weight-days__date").textContent;return l?s<M?-1:1:s>M?-1:1});let a=!1;e.innerHTML="",o(a).forEach(l=>e.appendChild(l));const n=document.querySelector(".weight-days .btn--more");let r=6;const u=l=>{l.forEach((f,w)=>{w<r?f.classList.add("show"):f.classList.contains("show")&&f.classList.remove("show")}),r>=l.length&&n.classList.add("hide")};u(o(a)),n.addEventListener("click",()=>{r+=6,u(o(a))}),document.querySelectorAll(".weight-days__switch button").forEach(l=>{l.addEventListener("click",()=>{var f;(f=document.querySelector(".weight-days__switch .btn--select"))==null||f.classList.remove("btn--select"),l.classList.add("btn--select"),a?a=!1:a=!0,e.innerHTML="",o(a).forEach(w=>e.appendChild(w)),u(o(a))})})},re=async()=>{const e=document.getElementById("graph");if(!e)return;const t=await Q(),o=t.chart_arr,a=t.ideal_weight;Chart.register(window["chartjs-plugin-annotation"]);const n=(i,h=!1)=>{const m=new Date;m.setHours(0,0,0,0);let v=new Date(m.setDate(m.getDate()+1)),b=new Date(m);const L={"7d":[7,14],"1m":[1,2],"3m":[3,6],"6m":[6,12],"1y":[12,24]};i==="7d"?(v.setDate(m.getDate()-(h?L[i][1]:L[i][0])),h&&b.setDate(m.getDate()-L[i][0])):(v.setMonth(m.getMonth()-(h?L[i][1]:L[i][0])),h&&b.setMonth(m.getMonth()-L[i][0]));let g=[],y=new Date(v);for(;y<b;)g.push(new Date(y.getTime()-y.getTimezoneOffset()*6e4).toISOString().split("T")[0]),y.setDate(y.getDate()+1);return g},r=(i,h=!1)=>{const m=n(i,h),v=Object.fromEntries(o.map(p=>[p.date,p.weight])),b=Object.fromEntries(o.map(p=>[p.date,p.bmi])),L=Object.fromEntries(o.map(p=>[p.date,p.bfp])),g=m.map(p=>v[p]??null),y=m.map(p=>b[p]??null),k=m.map(p=>L[p]??null);return{labels:m,dataset:g,bmi:y,bfp:k}},u=window.matchMedia("(max-width: 599px)");let c;const l=i=>{const{labels:h,dataset:m}=r(i),v=h.map(g=>g.replaceAll("-","/")),b=e.getContext("2d");c&&c.destroy(),c=new Chart(b,{type:"line",data:{labels:v,datasets:[{label:"体重（kg）",data:m,backgroundColor:"#4a90e2",borderColor:"#4a90e2",borderWidth:2,pointRadius:4,pointBackgroundColor:"#fff",pointBorderColor:"#4a90e2",pointBorderWidth:3,hoverBorderWidth:4,pointHoverRadius:6,spanGaps:!0}]},options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:u.matches?4/3:2/1,scales:{x:{ticks:{autoSkip:!0,callback(g){return h[g]?`${new Date(h[g]).getDate()}日`:""},maxRotation:0,minRotation:0,maxTicksLimit:15}},y:{suggestedMax:Math.max(...m)+1,suggestedMin:a-1,ticks:{maxTicksLimit:u.matches?6:8}}},plugins:{legend:{display:!1},tooltip:{titleFont:{size:u.matches?10:12,family:"Inter, Noto Sans JP, sans-serif"},bodyFont:{size:u.matches?12:14,family:"Inter, Noto Sans JP, sans-serif"},callbacks:{label(g){return` 体重: ${g.raw} kg`}}},annotation:{annotations:{goalLine:{type:"line",yMin:a,yMax:a,borderColor:"#e65100",borderWidth:2,borderDash:[6,6],label:{content:"目標体重",enabled:!0,position:"end"}}}}}}});const L=g=>{const y=g,k=Math.ceil(h.length/y);let p=0;c.data.datasets[0].data=m.map((B,P,x)=>{const d=x.length-1,S=d-P;if(P===d||S%k===0){let q=m.slice(p,P+1).filter(O=>O),D=q.reduce((O,V)=>parseFloat(O)+parseFloat(V),0);if(!D)return null;let R=(D/q.length).toFixed(1);return p=P+1,R}else return null})};if(u.matches?(L(12),c.update()):(L(31),c.update()),i==="3m"||i==="6m"||i==="1y"){let g=null;c.options.scales.x.ticks.callback=y=>{let k=new Date(h[y]),p=k.getMonth()+1,B=k.getDate();if(!(p===g||B!==1))return g=p,`${p}月`},c.update()}},f=i=>{const h=n(i).map(b=>b.replaceAll("-","/")),m=h[0],v=h[h.length-1];return`${m}～${v}`},w=document.querySelector(".weight-graph__date");let s="1m";l(s),w.innerHTML=f(s),u.addEventListener("change",()=>l(s));const M=document.querySelectorAll(".weight-graph__switch button"),I=document.querySelectorAll(".weight-summary__block");if(M.length<1)return;M.forEach(i=>{i.addEventListener("click",()=>{var h;(h=document.querySelector(".weight-graph__switch .btn--select"))==null||h.classList.remove("btn--select"),i.classList.add("btn--select")})});const C=i=>{const h=r(i),m=h.dataset.filter(d=>d!==null),v=h.bmi.filter(d=>d!==null),b=h.bfp.filter(d=>d!==null),g=r(i,!0).dataset.filter(d=>d!==null),y=(d,S=1)=>{const T=d.filter(D=>D!=null).map(D=>parseFloat(D.replace(/,/g,"")));return T.length?(T.reduce((D,R)=>D+R,0)/T.length).toFixed(S):null},k=(d,S)=>{if(d.length&&S.length){const T=(y(d)-y(S)).toFixed(1);return T>0?"+"+T:String(T)}else return null},p=d=>d.length?Math.max(...d).toFixed(1):null,B=d=>d.length?Math.min(...d).toFixed(1):null,P={average:y(m),bfp:y(b,2),bmi:y(v,2),in_de:k(m,g),best:p(m),lowest:B(m)};let x;i==="7d"&&(x="1週間"),i==="1m"&&(x="1ヶ月"),i==="3m"&&(x="3ヶ月"),i==="6m"&&(x="半年"),i==="1y"&&(x="1年"),I.forEach(d=>{d.querySelector(".period").innerHTML=x;const S=P[d.dataset.summary];S?d.querySelector(".weight-summary__num").innerHTML=S:d.querySelector(".weight-summary__num").innerHTML="--"})};C(s),document.getElementById("weight-graph__week").addEventListener("click",()=>{s="7d",l(s),w.innerHTML=f(s),C(s)}),document.getElementById("weight-graph__month").addEventListener("click",()=>{s="1m",l(s),w.innerHTML=f(s),C(s)}),document.getElementById("weight-graph__three-month").addEventListener("click",()=>{s="3m",l(s),w.innerHTML=f(s),C(s)}),document.getElementById("weight-graph__half-year").addEventListener("click",()=>{s="6m",l(s),w.innerHTML=f(s),C(s)}),document.getElementById("weight-graph__year").addEventListener("click",()=>{s="1y",l(s),w.innerHTML=f(s),C(s)})};document.querySelector("#header")&&ne();document.querySelector(".accordion")&&oe();document.querySelector("#header__info")&&se();document.querySelector(".weight-days__blocks")&&ae();document.querySelector("#graph")&&re();export{ce as a,le as b,ue as c,me as d,de as e,fe as f,ie as g,pe as h,_ as i,he as j};
