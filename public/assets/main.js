const me=e=>{const t=document.createElement("div");t.textContent=e,t.classList.add("copy-dialog"),document.body.appendChild(t),setTimeout(()=>t.classList.add("show"),10),setTimeout(()=>t.classList.remove("show"),1500),setTimeout(()=>t.remove(),2e3)};document.addEventListener("click",e=>{if(e.target.classList.contains("copy-link")){const t=e.target.closest(".copy-contents").querySelector(".copy__value");t&&(navigator.clipboard.writeText(t.textContent),document.querySelector(".copy-dialog")||me("IDをコピーしました。"))}});const S=()=>{x(document.querySelector(".validate-form")),document.addEventListener("input",()=>x(document.querySelector(".validate-form"))),document.addEventListener("change",()=>x(document.querySelector(".validate-form"))),document.querySelectorAll(".next-btn, .prev-btn").forEach(e=>{e.addEventListener("click",()=>{x(document.querySelector(".validate-form"))})})},x=e=>{if(!e)return!1;const a=[...(e.querySelector(".step.visible")||e).querySelectorAll("[required]")].every(c=>c.type==="radio"||c.type==="checkbox"?e.querySelector(`input[name="${c.name}"]:checked`):c.id==="password"?c.value.length>3:c.value.trim()!=="");return document.querySelectorAll(".submit-btn").forEach(c=>{a?c.classList.remove("disabled"):c.classList.add("disabled"),c.disabled=!a}),a},O=()=>{document.querySelectorAll(".basic-info-form__box").forEach(t=>{const n=t.querySelector("input"),o=t.querySelectorAll("select");n&&V(n,t),o.length&&o.forEach(a=>{V(a,t)})})},ge=(e,t)=>{e.tagName==="SELECT"?e.addEventListener("change",()=>V(e,t)):e.addEventListener("input",()=>V(e,t))},V=(e,t)=>{let n=t.querySelector(".validate-text")||t.nextElementSibling;const o=t.querySelector(".label-title")?t.querySelector(".label-title").textContent:t.querySelector(".label-name").textContent,a=o.includes("（")?o.substr(0,o.indexOf("（")):o;if(e.id==="password"){if(e.validity.valueMissing)return n.textContent=`${a}を入力してください`,t.classList.add("no-text"),!1;if(e.value.length<4)return n.textContent=`${a}は4文字以上で入力してください`,t.classList.add("no-text"),!1}else if(e.tagName==="INPUT"&&e.validity.valueMissing||e.tagName==="SELECT"&&e.value==="")return n.textContent=`${a}を入力してください`,t.classList.add("no-text"),!1;return n.textContent="",t.classList.remove("no-text"),!0},$=()=>{document.querySelectorAll(".validate-form__input").forEach(t=>{const n=t.querySelector("input"),o=t.querySelector("select"),a=t.querySelector("button");t.addEventListener("click",s=>{s.target===n?(t.classList.add("click"),t.classList.add("text-on"),ge(n,t)):s.target===o&&t.classList.add("click")}),document.addEventListener("click",s=>{n&&s.target!==n&&s.target!==a?(t.classList.remove("click"),n.value.trim()===""&&t.classList.remove("text-on")):o&&s.target!==o&&t.classList.remove("click")})})},J=e=>{document.querySelectorAll(e).forEach(t=>{t.addEventListener("input",n=>{n.target.value=n.target.value.replace(/[^a-zA-Z0-9 !"#$%&'()*+,-./:;<=>?@[\\\]^_`{|}~]/g,"")})})},he=e=>{document.querySelectorAll(e).forEach(t=>{t.addEventListener("input",n=>{n.target.value=n.target.value.replace(/[^0-9]/g,"")})})},P=e=>{document.querySelectorAll(e).forEach(t=>{t.addEventListener("input",()=>{let n=t.value;n=n.replace(/[^0-9.]/g,""),n=n.replace(/(\..*)\./g,"$1");const[o="",a=""]=n.split("."),s=o.slice(0,3),c=a.slice(0,1);n=c!==""||n.includes(".")?`${s}.${c}`:s;const i=parseFloat(n);!isNaN(i)&&i>999.9&&(n="999.9"),t.value=n})})},fe=()=>{S();const e=document.querySelector(".basic-info-form");e&&e.addEventListener("submit",t=>{t.preventDefault()})},pe=Object.freeze(Object.defineProperty({__proto__:null,init:fe},Symbol.toStringTag,{value:"Module"})),w=e=>{const t=e.replace(/^\/+/,"");return`${BASE_PATH}${t}`},ye=e=>{const t=new Image;t.src=e},ve=async(e,t)=>{var n;console.log("通信エラー:",e);try{const o=(n=t==null?void 0:t.headers)==null?void 0:n.get("Content-Type");o&&o.includes("application/json")?(console.log("サーバーレスポンス:",await t.json()),alert(`モーダルの読み込みに失敗しました。
`+e.message)):console.log("サーバーレスポンス:",await t.text())}catch(o){console.error("エラー内容の解析中に失敗しました:",o)}},b=async(e,t="GET",n=null,o={})=>{const a=await fetch(e,{method:t,body:n,...o});try{if(!a.ok)throw new Error(`APIエラー: ${a.status}`);const s=a.headers.get("Content-Type");return s&&s.includes("application/json")?await a.json():await a.text()}catch(s){return await ve(s,a),{success:!1,message:"通信エラーが発生しました。"}}},te=async e=>b(w(`/index.php?modal=${e}`)),we=async e=>b(w("/index.php?modal=login"),"POST",e),be=async e=>b(w("/index.php?modal=register"),"POST",e),_e=async()=>b(w("/api/chart_data.php")),K=e=>{const t=e.closest("[data-date]");return t?t.dataset.date:null};let R={};const ne=async e=>{const t=K(e);if(!t)return null;if(R[t])return R[t];const n=await b(w(`/api/record_data.php?date=${t}`));return n&&n.date?(R[t]=n,R[t]):null},Se=async e=>b(w("/index.php?modal=recordAdmin"),"POST",e),Ee=async e=>b(w("/index.php?modal=record"),"POST",e),Le=async e=>b(w("/index.php?modal=recordDelete"),"POST",e),De=async e=>b(w("/index.php?modal=recordReset"),"POST",e);let H=null;const qe=async()=>{if(H)return H;const e=await b(w("/api/user_data.php"));return e&&e.username?(H=e,H):null},ke=async e=>b(w("/index.php?modal=adminUser"),"POST",e),xe=async e=>b(w("/index.php?modal=adminAccount"),"POST",e),Te=async e=>b(w("/index.php?modal=accountDelete"),"POST",e),Ae=()=>{document.querySelector(".account-delete")&&document.getElementById("acc-delete-btn").addEventListener("click",async n=>{n.preventDefault();const o=await Te();window.history.scrollRestoration="manual",window.location.reload(),o.success||alert(o.message)})},Me=Object.freeze(Object.defineProperty({__proto__:null,init:Ae},Symbol.toStringTag,{value:"Module"})),Be=async()=>{$(),S(),J("input[data-alphanumeric]"),he("input[data-numeric]");const e=document.getElementById("login-form");e&&e.addEventListener("submit",async t=>{if(t.preventDefault(),O(),!x(e)){console.log("バリデーションエラー： フォーム送信をキャンセル");return}const o=new FormData(e),a=await we(o),s=document.querySelector(".form-message");a.success?window.location.href=w("/home"):(s.classList.add("error"),s.innerHTML=`ログインに失敗しました。<br>${a.errorMessage}`,s.style.display="block")})},Ie=Object.freeze(Object.defineProperty({__proto__:null,init:Be},Symbol.toStringTag,{value:"Module"})),oe=()=>{document.querySelectorAll(".btn--go-to-step2")&&document.querySelectorAll(".btn--go-to-step2").forEach(n=>{n.addEventListener("click",Z)}),document.getElementById("btn--go-to-step2")&&document.getElementById("btn--go-to-step2").addEventListener("click",Z),document.getElementById("btn--back-to-step1").addEventListener("click",Ce)},Z=()=>{document.getElementById("step1").classList.add("hidden"),document.getElementById("step1").classList.remove("visible"),document.getElementById("step2").classList.add("visible"),document.getElementById("step2").classList.remove("hidden")},Ce=()=>{document.getElementById("step2").classList.add("hidden"),document.getElementById("step2").classList.remove("visible"),document.getElementById("step1").classList.add("visible"),document.getElementById("step1").classList.remove("hidden")},je=()=>{oe();const e=document.querySelectorAll(".notice-contents"),t=document.querySelectorAll(".notice-detail"),n=a=>{t.forEach(s=>{s.classList.toggle("visible",s.id===a),s.classList.toggle("hidden",s.id!==a)})};e.forEach(a=>{a.addEventListener("click",()=>{n(a.dataset.notice)})});const o=document.querySelector("#header__notifications span");o.dataset.icon="notifications"},Pe=Object.freeze(Object.defineProperty({__proto__:null,init:je},Symbol.toStringTag,{value:"Module"})),Oe=e=>{$(),P("input[data-weight-input]");const t=document.querySelector(".modal-record-admin");if(e){const o=e.date.replace(/-/g,"/");t.querySelector(".date__contents").textContent=o,t.querySelector("#recorded_at").value=o,t.querySelector("#weight").value=e.weight,t.querySelector("#memo").value=e.memo||""}S(),document.addEventListener("input",S),document.addEventListener("change",S);const n=document.getElementById("record-form");n&&(n.addEventListener("submit",async a=>{if(a.preventDefault(),O(),!x(n)){console.log("バリデーションエラー： フォーム送信をキャンセル");return}const c=new FormData(n),i=await Se(c);window.history.scrollRestoration="manual",window.location.reload(),i.success||alert(i.message)}),document.getElementById("delete-btn").addEventListener("click",async a=>{a.preventDefault();const s=new FormData(n),c=await Le(s);window.history.scrollRestoration="manual",window.location.reload(),c.success||alert(c.message)}))},$e=Object.freeze(Object.defineProperty({__proto__:null,init:Oe},Symbol.toStringTag,{value:"Module"})),Fe=()=>{document.querySelector(".record-reset")&&document.getElementById("reset-btn").addEventListener("click",async n=>{n.preventDefault();const o=await De();window.history.scrollRestoration="manual",window.location.reload(),o.success||alert(o.message)})},Re=Object.freeze(Object.defineProperty({__proto__:null,init:Fe},Symbol.toStringTag,{value:"Module"})),X=e=>{const t=s=>("0"+s).slice(-2),n=e.getFullYear().toString(),o=t(e.getMonth()+1).toString(),a=t(e.getDate()).toString();return`${n}/${o}/${a}`},He=()=>{const e=document.getElementById("date-contents"),t=document.getElementById("date-prev"),n=document.getElementById("date-next");if(!e)return;const o=new Date,s=new Intl.DateTimeFormat("ja-JP",{timeZone:"Asia/Tokyo",year:"numeric",month:"2-digit",day:"2-digit"}).formatToParts(o),c=s.find(B=>B.type==="year").value,i=s.find(B=>B.type==="month").value,r=s.find(B=>B.type==="day").value,g=new Date(`${c}-${i}-${r}T00:00:00+09:00`);let p=new Date(g);const l=document.getElementById("recorded_at"),D=()=>{e.textContent=X(p),l.value=X(p),n.disabled=p.getTime()>=g.getTime()};D(),t.addEventListener("click",()=>{p.setDate(p.getDate()-1),D()}),n.addEventListener("click",()=>{p.getTime()<g.getTime()&&(p.setDate(p.getDate()+1),D())})},Ve=async()=>{He(),$(),P("input[data-weight-input]"),S(),document.addEventListener("input",S),document.addEventListener("change",S);const e=document.getElementById("record-form");e&&e.addEventListener("submit",async t=>{if(t.preventDefault(),O(),!x(e)){console.log("バリデーションエラー： フォーム送信をキャンセル");return}const o=new FormData(e),a=await Ee(o);window.history.scrollRestoration="manual",window.location.reload(),a.success||alert(a.message)})},Ne=Object.freeze(Object.defineProperty({__proto__:null,init:Ve},Symbol.toStringTag,{value:"Module"})),ae=()=>{const e=document.getElementById("birth-year"),t=document.getElementById("birth-month"),n=document.getElementById("birth-day");if(!e)return;const o=new Date().getFullYear();for(let s=o;s>=o-100;s--){let c=document.createElement("option");c.value=s,c.textContent=s,e.appendChild(c)}const a=()=>{const s=parseInt(e.value,10),c=parseInt(t.value,10);if(t.disabled=!s,n.disabled=!c,!c)return;const i=new Date(s,c,0).getDate();for(;n.options.length>1;)n.remove(1);for(let r=1;r<=i;r++){let g=document.createElement("option");g.value=r,g.textContent=r,n.appendChild(g)}};e.addEventListener("change",a),t.addEventListener("change",a),requestAnimationFrame(()=>{a()})},Ue=()=>{ae(),$(),S(),J("input[data-alphanumeric]"),P("input[data-height-input]"),P("input[data-weight-input]"),oe();const e=document.getElementById("register-form");e&&e.addEventListener("submit",async t=>{if(t.preventDefault(),O(),!x(e)){console.log("バリデーションエラー： フォーム送信をキャンセル");return}const o=new FormData(e),a=await be(o),s=document.querySelector(".form-message");a.success?(sessionStorage.setItem("accountCreated","true"),window.location.href=w("/home")):(s.classList.add("error"),s.innerHTML=`新規登録に失敗しました。<br>${a.errorMessage}`,s.style.display="block")})},ze=Object.freeze(Object.defineProperty({__proto__:null,init:Ue},Symbol.toStringTag,{value:"Module"})),We=e=>{ae(),$(),J("input[data-alphanumeric]"),P("input[data-height-input]"),P("input[data-weight-input]");const t=document.querySelector("#user-info-form"),n=document.querySelector(".admin-account-form"),o=document.querySelector(".admin-user-form"),a=document.querySelector(".modal");if(e){a.querySelector("#username").value=e.username,a.querySelector("#birth-year").value=e.birth_year,a.querySelector("#birth-month").value=e.birth_month,requestAnimationFrame(()=>{a.querySelector("#birth-day").value=e.birth_day});const s=document.querySelector(`input[name="gender"][value="${e.gender}`);s.checked=!0,a.querySelector("#height").value=e.height,a.querySelector("#ideal-weight").value=e.ideal_weight}S(),document.addEventListener("input",S),document.addEventListener("change",S),t&&t.addEventListener("submit",async s=>{if(s.preventDefault(),O(),!x(t)){console.log("バリデーションエラー： フォーム送信をキャンセル");return}const i=new FormData(t);let r;n&&(r=await xe(i)),o&&(r=await ke(i)),window.history.scrollRestoration="manual",window.location.reload(),r.success||alert(r.message)})},Ge=Object.freeze(Object.defineProperty({__proto__:null,init:We},Symbol.toStringTag,{value:"Module"})),Ye=()=>{const e=document.querySelectorAll(".pwd-btn");e.length&&e.forEach(t=>{t.dataset.inited!=="1"&&(t.dataset.inited="1",ce(t),t.addEventListener("click",()=>{Je(t)}))})},Je=e=>{const t=se(e);t&&(Ke(e,!G(e)),ce(e,t))},se=e=>{const t=e.previousElementSibling;return t&&t.tagName.toLowerCase()==="input"?t:null},Ke=(e,t)=>e.dataset.hidden=String(t),G=e=>e.dataset.hidden==="true",ce=(e,t=se(e))=>{if(!t)return;const n=G(e);t.type=n?"password":"text";const o=e.firstElementChild;o&&(o.dataset.icon=G(e)?"visibility":"visibility_off"),Qe(e,t,n)},Qe=(e,t,n)=>{t.id&&e.setAttribute("aria-controls",t.id),e.setAttribute("aria-pressed",String(!n)),e.setAttribute("aria-label",n?"パスワードを表示":"パスワードを非表示")},ie=document.querySelector("body"),Ze=document.getElementById("layout");let W=!1;const Y=new Map,I=new Map,Xe=(e,t)=>{const n={record:"./init/record.js",recordAdmin:"./init/record-admin.js",recordReset:"./init/record-reset.js",adminAccount:"./init/user-info.js",adminUser:"./init/user-info.js",login:"./init/login.js",register:"./init/register.js",accountCreated:"./init/account-created.js",accountDelete:"./init/account-delete.js",notifications:"./init/notifications.js"},o=Object.assign({"./init/account-created.js":pe,"./init/account-delete.js":Me,"./init/login.js":Ie,"./init/notifications.js":Pe,"./init/record-admin.js":$e,"./init/record-reset.js":Re,"./init/record.js":Ne,"./init/register.js":ze,"./init/user-info.js":Ge}),a=n[e],s=o[a];a&&typeof s.init=="function"&&s.init(t)},ee=async(e,t=null)=>{const n=e;let o=e,a=null;if(e==="recordAdmin"&&t){const c=K(t);if(!c)return;o=`recordAdmin-${c}`,I.has(o)||(a=await ne(t),I.set(o,a))}if(e==="adminUser"&&!I.has(o)&&(a=await qe(),I.set(o,a)),e==="record"&&ye("/images/date-arrow.svg"),Y.has(n))return;const s=await te(e);Y.set(n,s)},Q=async(e,t=null)=>{if(W)return;W=!0;const n=Y.get(e)||await te(e),o=t?I.get(t):null;Ze.insertAdjacentHTML("afterend",n),ie.style.overflow="hidden",Ye(),Xe(e,o),document.querySelectorAll(".close-modal").forEach(s=>{s&&s.addEventListener("click",re)}),W=!1},re=()=>{const e=document.getElementById("modal");e&&(e.remove(),ie.style.overflow="")},le=document.querySelectorAll("[data-modal]");le.forEach(e=>{e.addEventListener("click",async()=>{const t=e.getAttribute("data-modal");let n=t;if(t==="recordAdmin"){const o=K(e);o&&(n=`recordAdmin-${o}`)}if(!I.has(n)){const o=await ne(e);I.set(n,o)}Q(t,n)})});document.addEventListener("click",e=>{const t=document.querySelector("#modal.record, #modal.recordAdmin");t&&e.target===t&&re()});const de=new Set;le.forEach(e=>{const t=e.getAttribute("data-modal");de.add(t)});const et=document.querySelectorAll('[data-modal="recordAdmin"]');window.addEventListener("load",()=>{setTimeout(async()=>{const e=[...de].map(t=>ee(t));await Promise.all(e);for(const t of et)await ee("recordAdmin",t)},1e3)});sessionStorage.getItem("accountCreated")==="true"&&(Q("accountCreated"),sessionStorage.removeItem("accountCreated"));showIdModal&&Q("idCheck");const tt=()=>{const e=document.getElementById("header");if(!e)return;const t=e.offsetHeight;let n=0;window.addEventListener("load",()=>{window.addEventListener("scroll",()=>{const i=window.scrollY||document.documentElement.scrollTop;i>n&&i>t?e.style.top=`-${t}px`:e.style.top="0",n=i})});const o=document.getElementById("menu-toggle"),a=document.querySelector(".layout__sidebar");o.addEventListener("click",()=>{a.classList.contains("open")?(a.classList.remove("open"),a.classList.add("close")):(a.classList.remove("close"),a.classList.add("open"))});const s=window.matchMedia("(max-width: 1299px)"),c=i=>{i.matches?(a.classList.remove("open"),a.classList.add("close")):(a.classList.remove("close"),a.classList.add("open"))};c(s),s.addEventListener("change",c),document.addEventListener("click",i=>{i.target.closest(".layout__sidebar")||s.matches&&(a.classList.remove("open"),a.classList.add("close"))})},nt=()=>{const e=document.querySelectorAll(".accordion-btn");e&&e.forEach(t=>{t.addEventListener("click",()=>{const n=t.closest(".accordion"),o=n.querySelector(".accordion-content");n.getAttribute("data-state")==="open"?(o.style.maxHeight=o.scrollHeight+"px",requestAnimationFrame(()=>{o.style.maxHeight="0"}),n.setAttribute("data-state","close")):(o.style.maxHeight=o.scrollHeight+"px",n.setAttribute("data-state","open"))})})},ot=()=>{const e=document.getElementById("header__info"),t=document.getElementById("header__profile"),n=document.getElementById("user-popup");e&&(t.addEventListener("click",o=>{e.classList.contains("click")?e.classList.remove("click"):e.classList.add("click"),o.stopPropagation()}),document.addEventListener("click",o=>{!n.contains(o.target)&&o.target!==e&&e.classList.remove("click")}))},at=()=>{const e=document.querySelector(".weight-days__blocks"),t=document.querySelectorAll(".weight-days__block");if(!e)return;const n=r=>[...t].sort((g,p)=>{const l=g.querySelector(".weight-days__date").textContent,D=p.querySelector(".weight-days__date").textContent;return r?l<D?-1:1:l>D?-1:1});let o=!1;e.innerHTML="",n(o).forEach(r=>e.appendChild(r));const a=document.querySelector(".weight-days .btn--more");let s=6;const c=r=>{r.forEach((g,p)=>{p<s?g.classList.add("show"):g.classList.contains("show")&&g.classList.remove("show")}),s>=r.length&&a.classList.add("hide")};c(n(o)),a.addEventListener("click",()=>{s+=6,c(n(o))}),document.querySelectorAll(".weight-days__switch button").forEach(r=>{r.addEventListener("click",()=>{var g;(g=document.querySelector(".weight-days__switch .btn--select"))==null||g.classList.remove("btn--select"),r.classList.add("btn--select"),o?o=!1:o=!0,e.innerHTML="",n(o).forEach(p=>e.appendChild(p)),c(n(o))})})},st=async()=>{const e=document.getElementById("graph");if(!e)return;const t=await _e(),n=t.chart_arr,o=t.ideal_weight;Chart.register(window["chartjs-plugin-annotation"]);const a=(d,h=!1)=>{const m=new Date;m.setHours(0,0,0,0);let E=new Date(m.setDate(m.getDate()+1)),L=new Date(m);const _={"7d":[7,14],"1m":[1,2],"3m":[3,6],"6m":[6,12],"1y":[12,24]};d==="7d"?(E.setDate(m.getDate()-(h?_[d][1]:_[d][0])),h&&L.setDate(m.getDate()-_[d][0])):(E.setMonth(m.getMonth()-(h?_[d][1]:_[d][0])),h&&L.setMonth(m.getMonth()-_[d][0]));let y=[],v=new Date(E);for(;v<L;)y.push(new Date(v.getTime()-v.getTimezoneOffset()*6e4).toISOString().split("T")[0]),v.setDate(v.getDate()+1);return y},s=(d,h=!1)=>{const m=a(d,h),E=Object.fromEntries(n.map(f=>[f.date,f.weight])),L=Object.fromEntries(n.map(f=>[f.date,f.bmi])),_=Object.fromEntries(n.map(f=>[f.date,f.bfp])),y=m.map(f=>E[f]??null),v=m.map(f=>L[f]??null),T=m.map(f=>_[f]??null);return{labels:m,dataset:y,bmi:v,bfp:T}},c=window.matchMedia("(max-width: 599px)");let i;const r=d=>{const{labels:h,dataset:m}=s(d),E=h.map(y=>y.replaceAll("-","/")),L=e.getContext("2d");i&&i.destroy(),i=new Chart(L,{type:"line",data:{labels:E,datasets:[{label:"体重（kg）",data:m,backgroundColor:"#4a90e2",borderColor:"#4a90e2",borderWidth:2,pointRadius:4,pointBackgroundColor:"#fff",pointBorderColor:"#4a90e2",pointBorderWidth:3,hoverBorderWidth:4,pointHoverRadius:6,spanGaps:!0}]},options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:c.matches?4/3:2/1,scales:{x:{ticks:{autoSkip:!0,callback(y){return h[y]?`${new Date(h[y]).getDate()}日`:""},maxRotation:0,minRotation:0,maxTicksLimit:15}},y:{suggestedMax:Math.max(...m)+1,suggestedMin:o-1,ticks:{maxTicksLimit:c.matches?6:8}}},plugins:{legend:{display:!1},tooltip:{titleFont:{size:c.matches?10:12,family:"Inter, Noto Sans JP, sans-serif"},bodyFont:{size:c.matches?12:14,family:"Inter, Noto Sans JP, sans-serif"},callbacks:{label(y){return` 体重: ${y.raw} kg`}}},annotation:{annotations:{goalLine:{type:"line",yMin:o,yMax:o,borderColor:"#e65100",borderWidth:2,borderDash:[6,6],label:{content:"目標体重",enabled:!0,position:"end"}}}}}}});const _=y=>{const v=y,T=Math.ceil(h.length/v);let f=0;i.data.datasets[0].data=m.map((F,j,A)=>{const u=A.length-1,q=u-j;if(j===u||q%T===0){let N=m.slice(f,j+1).filter(z=>z),k=N.reduce((z,ue)=>parseFloat(z)+parseFloat(ue),0);if(!k)return null;let U=(k/N.length).toFixed(1);return f=j+1,U}else return null})};if(c.matches?(_(12),i.update()):(_(31),i.update()),d==="3m"||d==="6m"||d==="1y"){let y=null;i.options.scales.x.ticks.callback=v=>{let T=new Date(h[v]),f=T.getMonth()+1,F=T.getDate();if(!(f===y||F!==1))return y=f,`${f}月`},i.update()}},g=d=>{const h=a(d).map(L=>L.replaceAll("-","/")),m=h[0],E=h[h.length-1];return`${m}～${E}`},p=document.querySelector(".weight-graph__date");let l="1m";r(l),p.innerHTML=g(l),c.addEventListener("change",()=>r(l));const D=document.querySelectorAll(".weight-graph__switch button"),B=document.querySelectorAll(".weight-summary__block");if(D.length<1)return;D.forEach(d=>{d.addEventListener("click",()=>{var h;(h=document.querySelector(".weight-graph__switch .btn--select"))==null||h.classList.remove("btn--select"),d.classList.add("btn--select")})});const C=d=>{const h=s(d),m=h.dataset.filter(u=>u!==null),E=h.bmi.filter(u=>u!==null),L=h.bfp.filter(u=>u!==null),y=s(d,!0).dataset.filter(u=>u!==null),v=(u,q=1)=>{const M=u.filter(k=>k!=null).map(k=>parseFloat(k.replace(/,/g,"")));return M.length?(M.reduce((k,U)=>k+U,0)/M.length).toFixed(q):null},T=(u,q)=>{if(u.length&&q.length){const M=(v(u)-v(q)).toFixed(1);return M>0?"+"+M:String(M)}else return null},f=u=>u.length?Math.max(...u).toFixed(1):null,F=u=>u.length?Math.min(...u).toFixed(1):null,j={average:v(m),bfp:v(L,2),bmi:v(E,2),in_de:T(m,y),best:f(m),lowest:F(m)};let A;d==="7d"&&(A="1週間"),d==="1m"&&(A="1ヶ月"),d==="3m"&&(A="3ヶ月"),d==="6m"&&(A="半年"),d==="1y"&&(A="1年"),B.forEach(u=>{u.querySelector(".period").innerHTML=A;const q=j[u.dataset.summary];q?u.querySelector(".weight-summary__num").innerHTML=q:u.querySelector(".weight-summary__num").innerHTML="--"})};C(l),document.getElementById("weight-graph__week").addEventListener("click",()=>{l="7d",r(l),p.innerHTML=g(l),C(l)}),document.getElementById("weight-graph__month").addEventListener("click",()=>{l="1m",r(l),p.innerHTML=g(l),C(l)}),document.getElementById("weight-graph__three-month").addEventListener("click",()=>{l="3m",r(l),p.innerHTML=g(l),C(l)}),document.getElementById("weight-graph__half-year").addEventListener("click",()=>{l="6m",r(l),p.innerHTML=g(l),C(l)}),document.getElementById("weight-graph__year").addEventListener("click",()=>{l="1y",r(l),p.innerHTML=g(l),C(l)})};document.querySelector("#header")&&tt();document.querySelector(".accordion")&&nt();document.querySelector("#header__info")&&ot();document.querySelector(".weight-days__blocks")&&at();document.querySelector("#graph")&&st();
