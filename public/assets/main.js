const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["account-created-CQW4UpXI.js","form-validate-CVHGrpdv.js","login-CioBE2rb.js","record-admin-CrxHMQqo.js","record-DVU88GXU.js","register-CuBKLh5b.js","form-date-DC5VUZ3x.js","user-info-BbyuT7Ux.js"])))=>i.map(i=>d[i]);
const G=e=>{const t=document.createElement("div");t.textContent=e,t.classList.add("copy-dialog"),document.body.appendChild(t),setTimeout(()=>t.classList.add("show"),10),setTimeout(()=>t.classList.remove("show"),1500),setTimeout(()=>t.remove(),2e3)};document.addEventListener("click",e=>{if(e.target.classList.contains("copy-link")){const t=e.target.closest(".copy-contents").querySelector(".copy__value");t&&(navigator.clipboard.writeText(t.textContent),document.querySelector(".copy-dialog")||G("IDをコピーしました。"))}});const z="modulepreload",N=function(e){return"/assets/"+e},F={},A=function(t,s,o){let n=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),r=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));n=Promise.allSettled(s.map(i=>{if(i=N(i),i in F)return;F[i]=!0;const f=i.endsWith(".css"),w=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${w}`))return;const a=document.createElement("link");if(a.rel=f?"stylesheet":z,f||(a.as="script"),a.crossOrigin="",a.href=i,r&&a.setAttribute("nonce",r),document.head.appendChild(a),f)return new Promise((M,I)=>{a.addEventListener("load",M),a.addEventListener("error",()=>I(new Error(`Unable to preload CSS for ${i}`)))})}))}function d(u){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=u,window.dispatchEvent(r),!r.defaultPrevented)throw u}return n.then(u=>{for(const r of u||[])r.status==="rejected"&&d(r.reason);return t().catch(d)})},_=e=>{const t=e.replace(/^\/+/,"");return`${BASE_PATH}${t}`},E=async(e,t="GET",s=null,o={})=>{const n=await fetch(e,{method:t,body:s,...o});try{if(!n.ok)throw n.status===401&&(alert("ログインが必要です。"),window.location.href=_("/welcome")),new Error(`APIエラー: ${n.status}`);const d=n.headers.get("Content-Type");return d&&d.includes("application/json")?await n.json():await n.text()}catch(d){return console.log("エラー:",d),console.log("デバッグ:",await n.text()),{success:!1,message:"通信エラーが発生しました。"}}},J=async e=>E(_(`/index.php?modal=${e}`)),ce=async e=>E(_("/index.php?modal=login"),"POST",e),ie=async e=>E(_("/index.php?modal=register"),"POST",e),Q=async()=>E(_("/api/chart_data.php")),Y=e=>{const t=e.target.closest("[data-date]");return t?t.dataset.date:null},K=async e=>{const t=Y(e);return t?E(_(`/api/record_data.php?date=${t}`)):(console.log("日付を取得できませんでした。"),{success:!1,message:"日付を取得できませんでした。"})},le=async e=>E(_("/index.php?modal=recordAdmin"),"POST",e),de=async e=>E(_("/index.php?modal=record"),"POST",e),ue=async e=>E(_("/index.php?modal=recordDelete"),"POST",e),me=async e=>E(_("/index.php?modal=recordReset"),"POST",e),X=async()=>E(_("/api/user_data.php")),he=async e=>E(_("/index.php?modal=adminUser"),"POST",e),pe=async e=>E(_("/index.php?modal=adminAccount"),"POST",e),fe=async e=>E(_("/index.php?modal=accountDelete"),"POST",e),$=async()=>{const e=document.querySelectorAll(".pwd-btn");e.length&&e.forEach(t=>{t.addEventListener("click",()=>{const s=t.previousElementSibling,o=s.tagName.toLowerCase(),n=t.firstElementChild,d=t.dataset.hidden==="true";o==="input"&&(s.type=d?"text":"password"),d?n.innerHTML="visibility_off":n.innerHTML="visibility",t.dataset.hidden=!d})})},U=document.querySelector("body"),Z=document.getElementById("layout");let j=!1;const H=async(e,t)=>{if(j)return;j=!0;const s=await J(e);te(e,t),Z.insertAdjacentHTML("afterend",s),U.style.overflow="hidden",$(),document.querySelectorAll(".close-modal").forEach(n=>{n&&n.addEventListener("click",W)}),j=!1},W=()=>{const e=document.getElementById("modal");e&&(e.remove(),U.style.overflow="",$())},ee=document.querySelectorAll("[data-modal]");ee.forEach(e=>{e.addEventListener("click",async t=>{const s=e.getAttribute("data-modal");let o=null;s==="recordAdmin"&&t&&(o=await K(t)),s==="adminUser"&&(o=await X()),H(s,o)})});document.addEventListener("click",e=>{const t=document.querySelector("#modal.record, #modal.recordAdmin");t&&e.target===t&&W()});sessionStorage.getItem("accountCreated")==="true"&&(H("accountCreated"),sessionStorage.removeItem("accountCreated"));showIdModal&&H("idCheck");const te=(e,t)=>{const s={record:"./init/record.js",recordAdmin:"./init/record-admin.js",recordReset:"./init/record-reset.js",adminAccount:"./init/user-info.js",adminUser:"./init/user-info.js",login:"./init/login.js",register:"./init/register.js",accountCreated:"./init/account-created.js",accountDelete:"./init/account-delete.js"},o=Object.assign({"./init/account-created.js":()=>A(()=>import("./account-created-CQW4UpXI.js"),__vite__mapDeps([0,1])),"./init/account-delete.js":()=>A(()=>import("./account-delete-BnrA96Vl.js"),[]),"./init/login.js":()=>A(()=>import("./login-CioBE2rb.js"),__vite__mapDeps([2,1])),"./init/record-admin.js":()=>A(()=>import("./record-admin-CrxHMQqo.js"),__vite__mapDeps([3,1])),"./init/record-reset.js":()=>A(()=>import("./record-reset-DtVuFXUd.js"),[]),"./init/record.js":()=>A(()=>import("./record-DVU88GXU.js"),__vite__mapDeps([4,1])),"./init/register.js":()=>A(()=>import("./register-CuBKLh5b.js"),__vite__mapDeps([5,1,6])),"./init/user-info.js":()=>A(()=>import("./user-info-BbyuT7Ux.js"),__vite__mapDeps([7,6,1]))}),n=s[e];n&&o[n]?o[n]().then(d=>d.init(t)):console.warn(`未対応のモーダルタイプ: ${e}`)},ne=()=>{const e=document.getElementById("header");if(!e)return;const t=e.offsetHeight;let s=0;window.addEventListener("load",()=>{window.addEventListener("scroll",()=>{const r=window.scrollY||document.documentElement.scrollTop;r>s&&r>t?e.style.top=`-${t}px`:e.style.top="0",s=r})});const o=document.getElementById("menu-toggle"),n=document.querySelector(".layout__sidebar");o.addEventListener("click",()=>{n.classList.contains("open")?(n.classList.remove("open"),n.classList.add("close")):(n.classList.remove("close"),n.classList.add("open"))});const d=window.matchMedia("(max-width: 1299px)"),u=r=>{r.matches?(n.classList.remove("open"),n.classList.add("close")):(n.classList.remove("close"),n.classList.add("open"))};u(d),d.addEventListener("change",u),document.addEventListener("click",r=>{r.target.closest(".layout__sidebar")||d.matches&&(n.classList.remove("open"),n.classList.add("close"))})},oe=()=>{const e=document.querySelectorAll(".accordion-btn");e&&e.forEach(t=>{t.addEventListener("click",()=>{const s=t.closest(".accordion"),o=s.querySelector(".accordion-content");s.getAttribute("data-state")==="open"?(o.style.maxHeight=o.scrollHeight+"px",requestAnimationFrame(()=>{o.style.maxHeight="0"}),s.setAttribute("data-state","close")):(o.style.maxHeight=o.scrollHeight+"px",s.setAttribute("data-state","open"))})})},se=()=>{const e=document.getElementById("header__info"),t=document.getElementById("header__profile"),s=document.getElementById("user-popup");e&&(t.addEventListener("click",o=>{e.classList.contains("click")?e.classList.remove("click"):e.classList.add("click"),o.stopPropagation()}),document.addEventListener("click",o=>{!s.contains(o.target)&&o.target!==e&&e.classList.remove("click")}))},ae=()=>{const e=document.querySelector(".weight-days__blocks"),t=document.querySelectorAll(".weight-days__block");if(!e)return;const s=i=>[...t].sort((f,w)=>{const a=f.querySelector(".weight-days__date").textContent,M=w.querySelector(".weight-days__date").textContent;return i?a<M?-1:1:a>M?-1:1});let o=!1;e.innerHTML="",s(o).forEach(i=>e.appendChild(i));const n=document.querySelector(".weight-days .btn--more");let d=6;const u=i=>{i.forEach((f,w)=>{w<d?f.classList.add("show"):f.classList.contains("show")&&f.classList.remove("show")}),d>=i.length&&n.classList.add("hide")};u(s(o)),n.addEventListener("click",()=>{d+=6,u(s(o))}),document.querySelectorAll(".weight-days__switch button").forEach(i=>{i.addEventListener("click",()=>{var f;(f=document.querySelector(".weight-days__switch .btn--select"))==null||f.classList.remove("btn--select"),i.classList.add("btn--select"),o?o=!1:o=!0,e.innerHTML="",s(o).forEach(w=>e.appendChild(w)),u(s(o))})})},re=async()=>{const e=document.getElementById("graph");if(!e)return;const t=await Q(),s=t.chart_arr,o=t.ideal_weight;Chart.register(window["chartjs-plugin-annotation"]);const n=(c,h=!1)=>{const m=new Date;m.setHours(0,0,0,0);let v=new Date(m.setDate(m.getDate()+1)),b=new Date(m);const L={"7d":[7,14],"1m":[1,2],"3m":[3,6],"6m":[6,12],"1y":[12,24]};c==="7d"?(v.setDate(m.getDate()-(h?L[c][1]:L[c][0])),h&&b.setDate(m.getDate()-L[c][0])):(v.setMonth(m.getMonth()-(h?L[c][1]:L[c][0])),h&&b.setMonth(m.getMonth()-L[c][0]));let g=[],y=new Date(v);for(;y<b;)g.push(new Date(y.getTime()-y.getTimezoneOffset()*6e4).toISOString().split("T")[0]),y.setDate(y.getDate()+1);return g},d=(c,h=!1)=>{const m=n(c,h),v=Object.fromEntries(s.map(p=>[p.date,p.weight])),b=Object.fromEntries(s.map(p=>[p.date,p.bmi])),L=Object.fromEntries(s.map(p=>[p.date,p.bfp])),g=m.map(p=>v[p]??null),y=m.map(p=>b[p]??null),T=m.map(p=>L[p]??null);return{labels:m,dataset:g,bmi:y,bfp:T}},u=window.matchMedia("(max-width: 599px)");let r;const i=c=>{const{labels:h,dataset:m}=d(c),v=h.map(g=>g.replaceAll("-","/")),b=e.getContext("2d");r&&r.destroy(),r=new Chart(b,{type:"line",data:{labels:v,datasets:[{label:"体重（kg）",data:m,backgroundColor:"#4a90e2",borderColor:"#4a90e2",borderWidth:2,pointRadius:4,pointBackgroundColor:"#fff",pointBorderColor:"#4a90e2",pointBorderWidth:3,hoverBorderWidth:4,pointHoverRadius:6,spanGaps:!0}]},options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:u.matches?4/3:2/1,scales:{x:{ticks:{autoSkip:!0,callback(g){return h[g]?`${new Date(h[g]).getDate()}日`:""},maxRotation:0,minRotation:0,maxTicksLimit:15}},y:{suggestedMax:Math.max(...m)+1,suggestedMin:o-1,ticks:{maxTicksLimit:u.matches?6:8}}},plugins:{legend:{display:!1},tooltip:{titleFont:{size:u.matches?10:12,family:"Inter, Noto Sans JP, sans-serif"},bodyFont:{size:u.matches?12:14,family:"Inter, Noto Sans JP, sans-serif"},callbacks:{label(g){return` 体重: ${g.raw} kg`}}},annotation:{annotations:{goalLine:{type:"line",yMin:o,yMax:o,borderColor:"#e65100",borderWidth:2,borderDash:[6,6],label:{content:"目標体重",enabled:!0,position:"end"}}}}}}});const L=g=>{const y=g,T=Math.ceil(h.length/y);let p=0;r.data.datasets[0].data=m.map((B,P,k)=>{const l=k.length-1,S=l-P;if(P===l||S%T===0){let q=m.slice(p,P+1).filter(O=>O),D=q.reduce((O,V)=>parseFloat(O)+parseFloat(V),0);if(!D)return null;let R=(D/q.length).toFixed(1);return p=P+1,R}else return null})};if(u.matches?(L(12),r.update()):(L(31),r.update()),c==="3m"||c==="6m"||c==="1y"){let g=null;r.options.scales.x.ticks.callback=y=>{let T=new Date(h[y]),p=T.getMonth()+1,B=T.getDate();if(!(p===g||B!==1))return g=p,`${p}月`},r.update()}},f=c=>{const h=n(c).map(b=>b.replaceAll("-","/")),m=h[0],v=h[h.length-1];return`${m}～${v}`},w=document.querySelector(".weight-graph__date");let a="1m";i(a),w.innerHTML=f(a),u.addEventListener("change",()=>i(a));const M=document.querySelectorAll(".weight-graph__switch button"),I=document.querySelectorAll(".weight-summary__block");if(M.length<1)return;M.forEach(c=>{c.addEventListener("click",()=>{var h;(h=document.querySelector(".weight-graph__switch .btn--select"))==null||h.classList.remove("btn--select"),c.classList.add("btn--select")})});const C=c=>{const h=d(c),m=h.dataset.filter(l=>l!==null),v=h.bmi.filter(l=>l!==null),b=h.bfp.filter(l=>l!==null),g=d(c,!0).dataset.filter(l=>l!==null),y=(l,S=1)=>{const x=l.filter(D=>D!=null).map(D=>parseFloat(D.replace(/,/g,"")));return x.length?(x.reduce((D,R)=>D+R,0)/x.length).toFixed(S):null},T=(l,S)=>{if(l.length&&S.length){const x=(y(l)-y(S)).toFixed(1);return x>0?"+"+x:String(x)}else return null},p=l=>l.length?Math.max(...l).toFixed(1):null,B=l=>l.length?Math.min(...l).toFixed(1):null,P={average:y(m),bfp:y(b,2),bmi:y(v,2),in_de:T(m,g),best:p(m),lowest:B(m)};let k;c==="7d"&&(k="1週間"),c==="1m"&&(k="1ヶ月"),c==="3m"&&(k="3ヶ月"),c==="6m"&&(k="半年"),c==="1y"&&(k="1年"),I.forEach(l=>{l.querySelector(".period").innerHTML=k;const S=P[l.dataset.summary];S?l.querySelector(".weight-summary__num").innerHTML=S:l.querySelector(".weight-summary__num").innerHTML="--"})};C(a),document.getElementById("weight-graph__week").addEventListener("click",()=>{a="7d",i(a),w.innerHTML=f(a),C(a)}),document.getElementById("weight-graph__month").addEventListener("click",()=>{a="1m",i(a),w.innerHTML=f(a),C(a)}),document.getElementById("weight-graph__three-month").addEventListener("click",()=>{a="3m",i(a),w.innerHTML=f(a),C(a)}),document.getElementById("weight-graph__half-year").addEventListener("click",()=>{a="6m",i(a),w.innerHTML=f(a),C(a)}),document.getElementById("weight-graph__year").addEventListener("click",()=>{a="1y",i(a),w.innerHTML=f(a),C(a)})};document.querySelector("#header")&&ne();document.querySelector(".accordion")&&oe();document.querySelector("#header__info")&&se();document.querySelector(".weight-days__blocks")&&ae();document.querySelector("#graph")&&re();export{ce as a,le as b,ue as c,me as d,de as e,fe as f,ie as g,pe as h,_ as i,he as j};
